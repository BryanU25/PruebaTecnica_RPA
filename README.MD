# üß† Prueba T√©cnica ‚Äì Ingeniero de Automatizaci√≥n RPA (MISSION SAS)

Soluci√≥n desarrollada para automatizar el monitoreo de condiciones de viaje para la empresa **TravelCorp**, incluyendo la recolecci√≥n, procesamiento y visualizaci√≥n de datos meteorol√≥gicos, financieros y horarios.

---

## üèóÔ∏è Arquitectura de la soluci√≥n

La arquitectura del proyecto se basa en un modelo **modular y escalable**, dise√±ado para ejecutar la automatizaci√≥n de forma independiente del dashboard, permitiendo mantenimiento y extensiones futuras.  

El flujo general se divide en tres capas principales:

1. **Capa de Extracci√≥n y Procesamiento (Backend)**
   - Se encarga de obtener informaci√≥n desde las APIs p√∫blicas:
     - üå¶Ô∏è *Open-Meteo* ‚Üí datos clim√°ticos (temperatura, viento, lluvia, UV)
     - üí± *ExchangeRate API* ‚Üí tipos de cambio y simulaci√≥n de hist√≥rico
     - ‚è∞ *WorldTimeAPI* ‚Üí hora local y diferencia horaria con Bogot√°
   - Los datos se transforman en estructuras limpias y estandarizadas (`.json`).

2. **Capa de Automatizaci√≥n (Scheduler)**
   - Usa el m√≥dulo `automatizador.py` para ejecutar el flujo completo cada 30 minutos.
   - Versiona autom√°ticamente los resultados con timestamp (`resultado_general_YYYYMMDD_HHMMSS.json`).
   - Registra todos los eventos en logs rotativos:
     - `app.log` ‚Äî actividad general
     - `automatizacion.log` ‚Äî ejecuciones programadas
     - `error.log` ‚Äî errores cr√≠ticos

3. **Capa de Visualizaci√≥n (Frontend)**
   - Dashboard desarrollado con **Streamlit + Plotly**.
   - Permite analizar m√©tricas por ciudad, alertas activas y niveles de riesgo (IVV).
   - Consume los archivos generados por el proceso autom√°tico desde `/data`.

---

### üß† Diagrama de arquitectura general

```mermaid
graph TD
    A[Usuario / Evaluador] -->|Ejecuta| B[Dashboard Streamlit]
    B -->|Lee datos desde| C[(Archivos JSON en /data)]
    C -->|Visualizaci√≥n y an√°lisis| B 

    subgraph "Capa de Automatizaci√≥n"
        D[automatizador.py<br>Scheduler cada 30 min] --> E[main.py<br>Flujo principal]
        E --> F[procesar_ciudades.py<br>Integraci√≥n y IVV]
    end

    subgraph "Capa de Extracci√≥n"
        F --> G1[api_clima.py<br>Open-Meteo API]
        F --> G2[api_divisas.py<br>ExchangeRate API]
        F --> G3[api_tiempo.py<br>WorldTimeAPI]
    end

    subgraph "Capa de Logging"
        D --> H1[app.log]
        D --> H2[automatizacion.log]
        F --> H3[error.log]
    end
```

---

##üìÇ Estructura del proyecto:

PruebaTecnica_RPA/
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ api_clima.py
‚îÇ   ‚îú‚îÄ‚îÄ api_divisas.py
‚îÇ   ‚îú‚îÄ‚îÄ api_tiempo.py
‚îÇ   ‚îú‚îÄ‚îÄ procesar_ciudades.py
‚îÇ   ‚îú‚îÄ‚îÄ automatizador.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îÇ
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ config.json
‚îÇ   ‚îî‚îÄ‚îÄ config_logs.py
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ resultado_general_*.json
‚îÇ
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îú‚îÄ‚îÄ app.log
‚îÇ   ‚îú‚îÄ‚îÄ automatizacion.log
‚îÇ   ‚îî‚îÄ‚îÄ error.log
‚îÇ
‚îú‚îÄ‚îÄ dashboard/
‚îÇ   ‚îú‚îÄ‚îÄ app_dashboard.py
‚îÇ   ‚îî‚îÄ‚îÄ utils_dashboard.py
‚îÇ
‚îî‚îÄ‚îÄ requirements.txt

## üîÑ Diagrama de flujo del proceso

flowchart TD
    A[Iniciar automatizador] --> B[Extraer datos de APIs]
    B --> C[Procesar ciudades]
    C --> D[Evaluar alertas y calcular IVV]
    D --> E[Generar JSON estructurado]
    E --> F[Registrar logs y errores]
    F --> G[Dashboard Streamlit]
    G --> H[Visualizaci√≥n de m√©tricas y alertas]

## ‚öôÔ∏è Instrucciones de instalaci√≥n y ejecuci√≥n

üîπ Requisitos previos

    - Python 3.10 o superior
    - Git instalado
    - Entorno virtual (venv) recomendado

üîπ Instalaci√≥n
    - git clone https://github.com/BryanU25/PruebaTecnica_RPA.git
    - cd PruebaTecnica_RPA
    - python -m venv venv
    - source venv/bin/activate      # o venv\Scripts\activate en Windows
    - pip install -r requirements.txt

üîπ Ejecuci√≥n manual del proceso
    - python src/main.py

üîπ Ejecuci√≥n autom√°tica (cada 30 min)
    - python src/automatizador.py

üîπ Iniciar dashboard
    - streamlit run dashboard/app_dashboard.py

## üì¶ Descripci√≥n de m√≥dulos

| Archivo                  | Prop√≥sito principal                                                           |
| ------------------------ | ----------------------------------------------------------------------------- |
| **api_clima.py**         | Conexi√≥n con Open-Meteo API. Manejo de reintentos y validaci√≥n de estructura. |
| **api_divisas.py**       | Obtiene tipos de cambio desde ExchangeRate API y simula hist√≥rico de 5 d√≠as.  |
| **api_tiempo.py**        | Consulta zonas horarias y calcula diferencia con Bogot√°.                      |
| **procesar_ciudades.py** | Eval√∫a alertas, calcula IVV y genera estructura consolidada.                  |
| **automatizador.py**     | Ejecuta el proceso completo cada 30 minutos y versiona los resultados.        |
| **config_logs.py**       | Configura loggers rotativos: app.log, automatizacion.log y error.log.         |
| **app_dashboard.py**     | Visualizaci√≥n interactiva de IVV y alertas en Streamlit.                      |

## üõ°Ô∏è Manejo de errores implementado

    - Reintentos autom√°ticos: usando tenacity (3 intentos por API).
    - Control de excepciones: try/except con registro en logs y recuperaci√≥n del flujo.
    - Logs rotativos:
        * app.log ‚Äì operaciones generales
        * automatizacion.log ‚Äì ejecuciones programadas
        * error.log ‚Äì errores cr√≠ticos
    - Validaciones preventivas: si faltan datos, el sistema retorna nivel_riesgo="DESCONOCIDO" y un campo motivo explicativo.
    - Continuidad del proceso: fallos en una API no detienen la automatizaci√≥n general.